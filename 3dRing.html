
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title>Poster Circle</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="initial-scale=0.60, minimum-scale=0.60, maximum-scale=0.60">
        <style type="text/css">

            body {
                font-family: 'Lucida Grande', Verdana, Arial;
                font-size: 12px;
            }

            #stage {
                margin: 150px;
                height: 400px;
                -webkit-perspective: 800;
                display: inline-block;
                /*
                Setting the perspective of the contents of the stage
                but not the stage itself
                */
            }

            #rotate {
                margin: 0 auto;
                height: 400px;
                -webkit-transform-style: preserve-3d;
                float: left;
                /* Ensure that we're in 3D space */
                -webkit-transform-style: preserve-3d;
                padding-top: 100px;
            }

            .ring {
                margin: 0 auto;
                height: 100px;
                width: 100px;
                -webkit-transform-style: preserve-3d;
                -webkit-animation-iteration-count: infinite;
                -webkit-animation-timing-function: linear;
                padding: 15px;
            }

            .ring > :nth-child(odd) {
                background-color: #995C7F;
            }

            .ring > :nth-child(even) {
                background-color: #835A99;
            }

            .poster {
                position: absolute;
                width: 100px;
                height: 100px;
                opacity: 0.7;
                color: rgba(0,0,0,0.9);
                -webkit-border-radius: 10px;
            }

            .poster > p {
                font-family: 'Georgia', serif;
                font-size: 36px;
                font-weight: bold;
                text-align: center;
                margin-top: 28px;
            }

            /*
            Set up each row to have a different animation duration
            and alternating y-axis rotation directions.
            */
            /*.ring {
            -webkit-animation-name: x-spin;
            -webkit-animation-duration: 2s;
            }*/


            @-webkit-keyframes x-spin {
                0%    { -webkit-transform: rotateX(0deg); }
                100%  { -webkit-transform: rotateX(360deg); }
            }
            
            .numberInput{
                display: none;
            }


        </style>

        <script type="text/javascript">

            const POSTERS_PER_ROW = 12;
            const RING_RADIUS = 200;
            var posterAngle;;

            function setup_posters (row)
            {
                posterAngle = 360 / POSTERS_PER_ROW;
                for (var i = 0; i < POSTERS_PER_ROW; i ++) {
                    var poster = document.createElement('div');
                    poster.className = 'poster';
                    // compute and assign the transform for this poster
                    var transform = 'rotateX(' + getDefaultRotation(i) + 'deg) translateZ(' + RING_RADIUS + 'px)';
                    poster.style.webkitTransform = transform;
                    // setup the number to show inside the poster
                    var content = poster.appendChild(document.createElement('p'));
                    content.textContent = i;
                    // add the poster to the row
                    row.appendChild(poster);
                }

            }

            function getDefaultRotation(index){
                return posterAngle * index;
            }

            var styleElement;


            function updateDynamicCss(css){

                if(!styleElement){                
                    var head = document.head || document.getElementsByTagName('head')[0],
                        styleElement = document.createElement('style');

                    head.appendChild(styleElement);
                }

                styleElement.type = 'text/css';
                if (styleElement.styleSheet){
                    styleElement.styleSheet.cssText = css;
                } else {
                    styleElement.innerHTML = css;
                }
            }

            var ring1, ring2, ring3;

            var timeRun = 0;

            var defaultAnimationStuff = '-webkit-animation-duration: 5s; -webkit-animation-iteration-count: 1; -webkit-animation-fill-mode: forwards; -webkit-animation-timing-function: ease-in-out;';
            
            var currentState = [0,0,0];

            function init ()
            {
                ring1 = document.getElementById('ring-1');
                ring2 = document.getElementById('ring-2');
                ring3 = document.getElementById('ring-3');

                setup_posters(ring1);
                setup_posters(ring2);
                setup_posters(ring3);
                            

                document.querySelector('.startSpinn').addEventListener('click', function(){
                    document.body.appendChild

                    var cssStr = [];

                    i=4;
                    while(--i){

                        var input = document.getElementById('input'+i);

                        var num = Number(input.value) || 0;
                        var nextState = num = (0 - getDefaultRotation(num));    
                        num += (5 * 360);                       

                        cssStr.push('@-webkit-keyframes ringAnimation' + i + '' + timeRun + ' { 0% { -webkit-transform: rotateX(' + currentState[i] + 'deg); } 100% { -webkit-transform: rotateX(' + num + 'deg); }}');

                        var ring = document.getElementById('ring-' + i);                  
                        ring.setAttribute('style', '-webkit-transform: rotateX(' + currentState[i] + 'deg);'); 
                        
                         currentState[i] = nextState;
                    }


                    updateDynamicCss(cssStr.join(''));

                    i=4;
                    while(--i){                  
                        window.setTimeout(function(i, timeRun){ 
                            return function() {
                                document.getElementById('ring-' + i).setAttribute('style', '-webkit-animation-name: ringAnimation' + i + '' + timeRun +';' + defaultAnimationStuff); 
                            }
                        }(i, timeRun), 50 + (250 * (i - 1)));
                    }

                    timeRun++;
                });
            }

            // call init once the document is fully loaded
            window.addEventListener('load', init, false);


        </script>
    </head>

    <body>
        <div id="stage">
            <div id="rotate">
                <div id="ring-1" class="ring"></div>
                <input type="number" id="input1" class="numberInput">
            </div>
            <div id="rotate">
                <div id="ring-2" class="ring"></div>
                <input type="number" id="input2" class="numberInput">
            </div>
            <div id="rotate">
                <div id="ring-3" class="ring"></div>
                <input type="number" id="input3" class="numberInput">
            </div>
        </div>

        <input type="button" class="startSpinn" value="Start">

    </body>

</html>
